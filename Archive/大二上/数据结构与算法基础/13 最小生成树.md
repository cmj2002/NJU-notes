# 13 æœ€å°ç”Ÿæˆæ ‘

è€ƒè™‘ä¸€ä¸ªå¸¦æƒé‡çš„æ— å‘è¿é€šå›¾ $G=(V,E)$ï¼š

* ç”Ÿæˆæ ‘æ˜¯ä¸€ä¸ªåŒ…å« $V$ ä¸­æ‰€æœ‰èŠ‚ç‚¹ï¼Œè¾¹é›† $T$ æ˜¯ $E$ çš„å­é›†çš„æ ‘
* **æœ€å°ç”Ÿæˆæ ‘ï¼ˆMSTï¼‰**æ˜¯è¾¹çš„æ€»æƒé‡ $w(T)=\sum_{(u,v)\in T}w(u,v)$ æœ€å°çš„ç”Ÿæˆæ ‘

![image-20211202105907884](images/image-20211202105907884.png)

MSTå¹¿æ³›åº”ç”¨äºç½‘ç»œè®¾è®¡ï¼š

* è¿è¾“ç½‘ç»œè®¾è®¡
* ä¾›æ°´ç½‘ç»œè®¾è®¡
* é€šè®¯ç½‘ç»œè®¾è®¡
* è®¡ç®—æœºç½‘ç»œè®¾è®¡

MSTä¹Ÿæ˜¯ä¸€äº›å…¶ä»–é«˜çº§ç®—æ³•çš„é‡è¦å­ç¨‹åº

## äº§ç”ŸMST

* èµ·å§‹çŠ¶æ€ï¼šæ‰€æœ‰èŠ‚ç‚¹å’Œç©ºçš„è¾¹é›† $A$

* å°† safe edges åŠ å…¥ $A$ ï¼Œç»´æŠ¤å¾ªç¯ä¸å˜é‡ä½¿å¾— $A$ æ˜¯ $MST$ çš„å­é›†

  >Find some edge (These edges also called â€œ**safe edges**â€.) to add to A, maintaining the invariant that â€œA is a subset of some MSTâ€.
  > (At anytime, A is the edge set of a spanning forest.)
  >
  >å®‰å…¨è¾¹æŒ‡è¾¹ $(u,v)$ ä½¿å¾— $A$ ä¸ºæŸæ£µæœ€å°ç”Ÿæˆæ ‘çš„å­é›†æ—¶ï¼Œ $A\cup \{(u,v)\}$ ä¹Ÿæ˜¯æŸæ£µæœ€å°ç”Ÿæˆæ ‘çš„å­é›†ã€‚

* é‡å¤ä¸Šä¸€æ­¥ç›´åˆ°è·å¾—ä¸€ä¸ªç”Ÿæˆæ ‘ï¼ˆåˆ¤æ–­æ ‡å‡†ï¼š $|A|=n-1$ï¼‰

```pseudocode
GenericMST(G,w):
A = âˆ…
while (A is not a spanning tree)
  Find edge (ğ‘¢,ğ‘£) maintaining the invariant
  A = A âˆª {(ğ‘¢,ğ‘£)}
return A
```

**åé¢ä»‹ç»çš„ä¸‰ç§ç®—æ³•éƒ½æ˜¯è¿™ä¸€ç®—æ³•çš„ç»†åŒ–ï¼Œå„ä½¿ç”¨ä¸€ç§ç‰¹å®šçš„æ–¹å¼æ‰¾åˆ° safe edgeã€‚ä½†æ˜¯é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šä¸€ä¸ª safe edge åº”å½“æ»¡è¶³ä»€ä¹ˆæ¡ä»¶**

### æ‰¾å‡º safe edge

æˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸€äº›å®šä¹‰ï¼š

* æ— å‘å›¾ $G=(V, E)$ çš„ä¸€ä¸ª**åˆ‡å‰²(cut)** $(S, V-S)$ æ˜¯é›†åˆ $V$ çš„ä¸€ä¸ªåˆ’åˆ†, å¦‚å›¾ 23-2 æ‰€ç¤ºã€‚

* å¦‚æœä¸€æ¡è¾¹ $(u, v) \in E$ çš„ä¸€ä¸ªç«¯ç‚¹ä½äºé›†åˆ $S$, å¦ä¸€ä¸ªç«¯ç‚¹ä½äºé›†åˆ $V-S$, åˆ™ç§°è¯¥æ¡è¾¹**æ¨ªè·¨åˆ‡å‰²(cross)** $(S, V-S)$ ã€‚

* å¦‚æœé›†åˆ $A$ ä¸­ä¸å­˜åœ¨æ¨ªè·¨è¯¥åˆ‡å‰²çš„è¾¹, åˆ™ç§°è¯¥åˆ‡å‰²**å°Šé‡(respects)**é›†åˆ $A$ ã€‚

* åœ¨æ¨ªè·¨ä¸€ä¸ªåˆ‡å‰²çš„æ‰€æœ‰è¾¹ä¸­, æƒé‡æœ€å°çš„è¾¹ç§°ä¸º**è½»é‡çº§è¾¹(light edge)**ã€‚

  > æ³¨æ„, è½»é‡çº§è¾¹å¯èƒ½ä¸æ˜¯å”¯ä¸€çš„ã€‚ä¸€èˆ¬, å¦‚æœä¸€æ¡è¾¹æ˜¯æ»¡è¶³æŸä¸ªæ€§è´¨çš„æ‰€æœ‰è¾¹ä¸­æƒé‡æœ€å°çš„, åˆ™ç§°è¯¥æ¡è¾¹æ˜¯æ»¡è¶³ç»™å®šæ€§è´¨çš„ä¸€æ¡è½»é‡çº§è¾¹ã€‚

![image-20211202114031237](images/image-20211202114031237.png)

#### å®šç†1

å‡è®¾ï¼š

* $G=(V, E)$ æ˜¯ä¸€ä¸ªåœ¨è¾¹ $E$ ä¸Šå®šä¹‰äº†å®æ•°å€¼æƒé‡å‡½æ•° $w$ çš„è¿é€šæ— å‘å›¾ã€‚

* é›†åˆ $A$ ä¸º $E$ çš„ä¸€ä¸ªå­é›†, ä¸” $A$ åŒ…æ‹¬åœ¨å›¾ $G$ çš„æŸæ£µæœ€å°ç”Ÿæˆæ ‘ä¸­

* $(S, V-S)$ æ˜¯å›¾ $G$ ä¸­å°Šé‡é›†åˆ $A$ çš„ä»»æ„ä¸€ä¸ªåˆ‡å‰²

* $(u, v)$ æ˜¯æ¨ªè·¨åˆ‡å‰² $(S, V-S)$ çš„ä¸€æ¡è½»é‡çº§è¾¹ã€‚

é‚£ä¹ˆè¾¹ $(u, v)$ å¯¹äºé›†åˆ $A$ æ˜¯å®‰å…¨çš„ã€‚

**è¯æ˜**

è®¾ $T$ æ˜¯ä¸€æ£µåŒ…æ‹¬ $A$ çš„æœ€å°ç”Ÿæˆæ ‘, å¹¶å‡å®š $T$ ä¸åŒ…å«è½»é‡çº§è¾¹ $(u, v)$; å¦åˆ™, æˆ‘ä»¬å·²ç»è¯æ˜å®Œæ¯•ã€‚

ç°åœ¨æ¥æ„å»ºå¦ä¸€æ£µæœ€å°ç”Ÿæˆæ ‘ $T^{\prime}$, æˆ‘ä»¬é€šè¿‡å‰åˆ‡å’Œç²˜è´´æ¥å°† $A \cup\{(u, v)\}$ åŒ…æ‹¬åœ¨ æ ‘ $T^{\prime}$ ä¸­, ä»è€Œè¯æ˜ $(u, v)$ å¯¹äºé›†åˆ $A$ æ¥è¯´æ˜¯å®‰å…¨çš„ã€‚

è¾¹ $(u, v)$ ä¸ $T$ ä¸­ä»ç»“ç‚¹ $u$ åˆ°ç»“ç‚¹ $v$ çš„ç®€å•è·¯å¾„ $p$ å½¢æˆä¸€ä¸ªç¯è·¯, å¦‚å›¾ 23-3 æ‰€ç¤ºã€‚

![image-20211202115106890](images/image-20211202115106890.png)

ç”±äºç»“ç‚¹ $u$ å’Œç»“ç‚¹ $v$ åˆ†åˆ«å¤„åœ¨åˆ‡å‰² $(S, V-S)$ çš„ä¸¤ç«¯, $T$ ä¸­è‡³å°‘æœ‰ä¸€æ¡è¾¹å±äºç®€å•è·¯å¾„ $p$ å¹¶ä¸”æ¨ªè·¨è¯¥åˆ‡ å‰²ã€‚è®¾ $(x, y)$ ä¸ºè¿™æ ·çš„ä¸€æ¡è¾¹ã€‚

å› ä¸ºåˆ‡å‰² $(S, V-S)$ å°Šé‡é›†åˆ $A$, è¾¹ $(x, y)$ ä¸åœ¨é›†åˆ $A$ ä¸­ã€‚ç”±äºè¾¹ $(x, y)$ ä½äº $T$ ä¸­ä» $u$ åˆ° $v$ çš„å”¯ä¸€ç®€å•è·¯å¾„ä¸Š, å°†è¯¥æ¡è¾¹åˆ é™¤ä¼šå¯¼è‡´ $T$ è¢«åˆ†è§£ä¸ºä¸¤ä¸ªè¿é€šåˆ†é‡ã€‚ 

å°† $(u, v)$ åŠ ä¸Šå»å¯å°†è¿™ä¸¤ä¸ªè¿é€šåˆ†é‡è¿æ¥èµ·æ¥å½¢æˆä¸€æ£µæ–°çš„ç”Ÿæˆæ ‘ $T^{\prime}=T-\{(x, y)\} \cup\{(u, v)\}$ ã€‚

ä¸‹é¢è¯æ˜ $T^{\prime}$ æ˜¯ä¸€æ£µæœ€å°ç”Ÿæˆæ ‘ã€‚ç”±äºè¾¹ $(u, v)$ æ˜¯æ¨ªè·¨åˆ‡å‰² $(S, V-S)$ çš„ä¸€æ¡è½»é‡çº§è¾¹å¹¶ä¸”è¾¹ $(x, y)$ ä¹Ÿæ¨ªè·¨è¯¥åˆ‡å‰², æˆ‘ä»¬æœ‰ $w(u, v) \leqslant w(x, y)$ ã€‚å› æ­¤,
$$
w\left(T^{\prime}\right)=w(T)-w(x, y)+w(u, v) \leqslant w(T)
$$
ä½†æ˜¯, $T$ æ˜¯ä¸€æ£µæœ€å°ç”Ÿæˆæ ‘, æˆ‘ä»¬æœ‰ $w(T) \leqslant w\left(T^{\prime}\right) ;$ å› æ­¤, $T^{\prime}$ ä¸€å®šä¹Ÿæ˜¯ä¸€æ£µæœ€å°ç”Ÿæˆæ ‘ã€‚

ä¸‹é¢è¿˜éœ€è¦è¯æ˜è¾¹ $(u, v)$ å¯¹äºé›†åˆ $A$ æ¥è¯´æ˜¯ä¸€æ¡å®‰å…¨è¾¹ã€‚å› ä¸º $A \subseteq T$ å¹¶ä¸” $(x, y) \notin A$, æ‰€ä»¥æœ‰ $A \subseteq T^{\prime} ;$ å› æ­¤ $A \cup\{(u, v)\} \subseteq T^{\prime}$ ã€‚ç”±äº $T^{\prime}$ æ˜¯æœ€å°ç”Ÿæˆæ ‘, $(u, v)$ å¯¹äºé›†åˆ $A$ æ˜¯å®‰å…¨çš„ã€‚

å®šç†1èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£è¿é€šå›¾ $G=(V, E)$ ä¸Šç®—æ³• $G E N E R I C-M S T$ çš„å·¥ä½œåŸç†ã€‚éšç€è¯¥ç®—æ³•çš„æ¨è¿›, é›†åˆ $A$ æ€»æ˜¯ä¿æŒåœ¨æ— ç¯çŠ¶æ€; å¦åˆ™, åŒ…å« $A$ çš„æœ€å°ç”Ÿæˆæ ‘å°†åŒ…å«ä¸€ä¸ªç¯è·¯,è¿™å°†ä¸æ ‘çš„å®šä¹‰ç›¸çŸ›ç›¾ã€‚

åœ¨ç®—æ³•æ‰§è¡Œçš„ä»»æ„æ—¶åˆ», å›¾ $G_{A}=(V, A)$ æ˜¯ä¸€ä¸ªæ£®æ—, $G_{A}$ ä¸­çš„æ¯ä¸ªè¿é€šåˆ†é‡åˆ™æ˜¯ä¸€æ£µæ ‘ (æŸäº›æ ‘å¯èƒ½ä»…åŒ…å«ä¸€ä¸ªç»“ç‚¹ï¼Œå¦‚åœ¨ç®—æ³•å¼€å§‹æ—¶, é›†åˆ $A$ ä¸ºç©º, è€Œæ£®æ—ä¸­åŒ…å«$|V|$ æ£µæ ‘, æ¯æ£µæ ‘ä¸­åªæœ‰ä¸€ä¸ªç»“ç‚¹)ã€‚

è€Œä¸”, ç”±äº $A \cup\{(u, v)\}$ å¿…é¡»æ˜¯æ— ç¯çš„, æ‰€æœ‰å¯¹äºé›†åˆ $A$ä¸ºå®‰å…¨çš„è¾¹ $(u, v)$ æ‰€è¿æ¥çš„æ˜¯ $G_{A}$ ä¸­ä¸åŒçš„è¿é€šåˆ†é‡ã€‚

GENERIC-MST ç®—æ³•çš„ç¬¬ $2 \sim 4$ è¡Œçš„ while å¾ªç¯æ‰§è¡Œçš„æ€»æ¬¡æ•°ä¸º $|V|-1$ æ¬¡, å› ä¸ºè¯¥å¾ªç¯çš„æ¯éå¾ªç¯éƒ½æ‰¾å‡ºæœ€å°ç”Ÿæˆæ ‘æ‰€éœ€ $|V|-1$ æ¡è¾¹ä¸­çš„ä¸€æ¡ã€‚åœ¨åˆå§‹æ—¶, å½“ $A=\varnothing$ æ—¶, $G_{A}$ ä¸­æœ‰ $|V|$ æ£µæ ‘, æ¯éå¾ªç¯å°†æ ‘çš„æ•°é‡å‡å°‘ 1 æ£µã€‚å½“æ•´ä¸ªæ£®æ—ä»…åŒ…å«ä¸€æ£µæ ‘æ—¶, è¯¥ç®—æ³•å°±ç»ˆæ­¢ã€‚

#### æ¨è®º

ä¸‹é¢ä»‹ç»çš„ä¸¤ä¸ªç®—æ³•å°†ä½¿ç”¨ä¸‹åˆ—æ¨è®ºï¼š

è®¾ï¼š

* $G=(V, E)$ æ˜¯ä¸€ä¸ªè¿é€šæ— å‘å›¾, å¹¶æœ‰å®šä¹‰åœ¨è¾¹é›†åˆ $E$ ä¸Šçš„å®æ•°å€¼æƒé‡å‡½æ•° $w$ ã€‚
* é›†åˆ $A$ ä¸º $E$ çš„ä¸€ä¸ªå­é›†, ä¸”è¯¥å­é›†åŒ…æ‹¬åœ¨ $G$ çš„æŸæ£µæœ€å°ç”Ÿæˆæ ‘é‡Œ
* $C=\left(V_{C}, E_{C}\right)$ ä¸ºæ£®æ— $G_{A}=(V, A)$ ä¸­çš„ä¸€ä¸ªè¿é€šåˆ†é‡(æ ‘)ã€‚

å¦‚æœè¾¹ $(u, v)$ æ˜¯è¿æ¥ $C$ å’Œ $G_{A}$ ä¸­æŸä¸ªå…¶ä»–è¿é€šåˆ†é‡çš„ä¸€æ¡è½»é‡çº§è¾¹, åˆ™è¾¹ $(u, v)$ å¯¹äºé›†åˆ $A$ æ˜¯å®‰å…¨çš„ã€‚

**è¯æ˜**

åˆ‡å‰² $\left(V_{C}, V-V_{C}\right)$ å°Šé‡é›†åˆ $A$, è¾¹ $(u, v)$ æ˜¯æ¨ªè·¨è¯¥åˆ‡å‰²çš„ä¸€æ¡è½»é‡çº§è¾¹, å› æ­¤, è¾¹ $(u, v)$ å¯¹äºé›†åˆ $A$ æ˜¯å®‰å…¨çš„ã€‚

### Kruskal

ä»æ‰€æœ‰ç‚¹å’Œ $0$ æ¡è¾¹å¼€å§‹ï¼Œé€‰æ‹©è¿æ¥ä¸¤æ£µæ ‘çš„æœ€å°æƒé‡è¾¹ã€‚

```pseudocode
KruskalMST(G,w):
A = âˆ…
Sort edges into weight increasing order
for (each edge (ğ‘¢,ğ‘£) taken in weight increasing order)
  if (adding edge (ğ‘¢,ğ‘£) does not form cycle in A)
    A = A âˆª {(ğ‘¢,ğ‘£)}
return A
```

æˆ–è€…å†™å…·ä½“ä¸€ç‚¹ï¼š

```pseudocode
KruskalMST(G,w):
A = âˆ…
Sort edges into weight increasing order
for (each node u in V(G))
  MakeSet(u)
for (each edge (u,v) taken in weight increasing order)
  if (Find(u) != Find(v))
    A = A âˆª {(u,v)}
    Union(u,v)
return A
```

#### æ—¶é—´å¤æ‚åº¦

![image-20211208113610845](images/image-20211208113610845.png)

### Prim

MWOEï¼šminimum-weight-outgoing-edge

> â€¢**Cut Property****:** Assume A is included in some MST, let $G_A=(V,A)$. 
>  For any CC in $G_A$, its minimum-weight-outgoing-edge in $G$ is safe for $A$.
>
> â€¢**Strategy for finding safe edge in Primâ€™s algorithm:
> ** Keep finding MWOE in one *fixed* CC in G_A.

ç­–ç•¥ï¼šæ‰¾åˆ°MWOEä½œä¸º safe edge

primèƒ½å¤„ç†è¾¹æƒä¸ºè´Ÿçš„æƒ…å†µï¼Œå…¶ä»–å¯èƒ½åœ¨è¾¹æƒä¸ºè´Ÿæ—¶æ­£ç¡®æ€§å‡ºé”™ï¼ˆæ²¡è¯è¿‡ï¼Œä¸ä¸€å®šï¼‰

```pseudocode
PrimMST(G,w):
Pick an arbitrary node x
for (each node u)
  u.dist = INF, u.parent = NIL, u.in = false
x.dist = 0
Build a priority queue Q based on â€œdistâ€ values
while (Q is not empty)
  u = Q.ExtractMin()
  u.in = true
  for (each edge (u,v))
    if (v.in==false and w(u,v)<v.dist)
      v.parent = u, v.dist = w(u,v)
      Q.Update(v,w(u,v))
```

#### æ—¶é—´å¤æ‚åº¦

![image-20211208113451862](images/image-20211208113451862.png)

è¿™é‡Œ priority queue ä½¿ç”¨ binary heap å®ç°

### BorÅ¯vka

è¿™ä¸ªåœ¨ä¹¦ä¸Šæ²¡è®²ï¼Œä½†æ˜¯è®²ä¹‰æœ‰

ç±»ä¼¼ä¸Primï¼Œä½†æ˜¯Primå¯¹ä¸€ä¸ªå›ºå®šçš„CCå¯»æ‰¾MWOEå¹¶æ·»åŠ ï¼ŒBorÅ¯vkaåŒæ—¶å¯¹æ‰€æœ‰MWOEè¿›è¡Œå¯»æ‰¾å’Œæ·»åŠ 

è¿™å®é™…ä¸Šæ˜¯æœ€æ—©çš„MSTäº§ç”Ÿç®—æ³•

```pseudocode
BoruvkaMST(G,w):
Gâ€™ = (V,âˆ…)
do
  ccCount = CountCCAndLabel(Gâ€™) 
  for (i=1 to ccCount)
    safeEdge[i] = NIL
  for (each edge (u,v) in E(G))
    if (u.ccNum != v.ccNum)
      if (safeEdge[u.ccNum]==NIL or w(u,v)<w(safeEdge[u.ccNum]))
        safeEdge[u.ccNum] = (u,v)
      if (safeEdge[v.ccNum]==NIL or w(u,v)<w(safeEdge[v.ccNum]))
        safeEdge[v.ccNum] = (u,v)
  for (i=1 to ccCount)
    Add safeEdge[i] to E(Gâ€™)
while (ccCount > 1)
return E(Gâ€™)
```

#### æ—¶é—´å¤æ‚åº¦

![image-20211208114356167](images/image-20211208114356167.png)

BorÅ¯vka**å…è®¸å¹¶è¡Œè®¡ç®—**ã€‚

### æ€»ç»“

![image-20211208114512377](images/image-20211208114512377.png)