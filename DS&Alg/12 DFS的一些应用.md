# 12 DFSçš„ä¸€äº›åº”ç”¨

## æœ‰å‘æ— ç¯å›¾(directed acyclic graph, DAG)

é€‚åˆè¡¨ç¤ºå› æœå…³ç³»ã€å±‚æ¬¡ç»“æ„å’Œæ—¶é—´ä¾èµ–å…³ç³»

ä¾‹å¦‚æ—¶é—´ä¾èµ–å…³ç³»ï¼š

![image-20211127111858487](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211127111858487.png)

### æ‹“æ‰‘æ’åº(topological sort)

DAGçš„æ‹“æ‰‘æ’åºæŒ‡**å¯¹èŠ‚ç‚¹è¿›è¡Œçº¿æ€§æ’åº**ï¼Œè¿™ä¸ªæ’åºæ»¡è¶³**å¦‚æœDAGä¸­åŒ…æ‹¬è¾¹ $(u,v)$ï¼Œé‚£ä¹ˆåœ¨æ’åºä¸­ $u$ å‡ºç°åœ¨ $v$ ä¹‹å‰**

$E(G)$ æ˜¯ $V(G)$ çš„ä¸€ä¸ª**ååº**å…³ç³»ï¼Œè€Œä¸€ä¸ªæ‹“æ‰‘æ’åºæ˜¯æ»¡è¶³ $E(G)$ çš„ä¸€ä¸ª $V(G)$ çš„**å…¨åº**å…³ç³»

* å¦‚æœå›¾åŒ…å«ç¯ï¼Œæ‹“æ‰‘æ’åºæ˜¯ä¸å¯èƒ½çš„
* ä¸€ä¸ªå›¾å¯èƒ½æœ‰å¤šä¸ªä¸åŒçš„æ‹“æ‰‘æ’åº

#### ç”Ÿæˆæ‹“æ‰‘æ’åº

![image-20211127113240145](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211127113240145.png)

ç®—æ³•ï¼š

* ä½¿ç”¨ `DFS(G)` å¯¹å›¾è¿›è¡Œéå†ï¼Œå¾—åˆ°å¯¹æ¯ä¸ªèŠ‚ç‚¹çš„ä¸€ä¸ªå®Œæˆæ—¶é—´ `u.f`
* å½“ä¸€ä¸ªèŠ‚ç‚¹å®Œæˆæ—¶ï¼Œå°†å®ƒæ’å…¥è¾“å‡ºé“¾è¡¨çš„å¤´éƒ¨
* å¦‚æœDFSå®Œæˆä¸”æ²¡æœ‰å‘ç°ç¯ï¼Œè¾“å‡ºé“¾è¡¨ã€‚

æ—¶é—´å¤æ‚åº¦ $O(m+n)$

![image-20211127114948342](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211127114948342.png)

#### å¦ä¸€ç§ç”Ÿæˆæ‹“æ‰‘æ’åºçš„æ–¹æ³•

ä¸€ä¸ªæºèŠ‚ç‚¹(source node)æ˜¯æ²¡æœ‰å…¥è¾¹çš„èŠ‚ç‚¹

ä¸€ä¸ªä¸‹æ²‰ç‚¹(sink node)æ˜¯æ²¡æœ‰å‡ºè¾¹çš„èŠ‚ç‚¹

æ³¨æ„åˆ°ï¼š

* æ¯ä¸ªDAGéƒ½æœ‰è‡³å°‘ä¸€ä¸ªæºèŠ‚ç‚¹å’Œä¸€ä¸ªä¸‹æ²‰ç‚¹

* åœ¨å¯¹DAGè¿›è¡ŒDFSæ—¶ï¼ŒæºèŠ‚ç‚¹çš„å®Œæˆæ—¶é—´æœ€å¤§
* åœ¨å¯¹DAGè¿›è¡ŒDFSæ—¶ï¼Œä¸‹æ²‰ç‚¹çš„å®Œæˆæ—¶é—´æœ€å°

æ‰€ä»¥è®¾è®¡ç®—æ³•ï¼š

* æ‰¾å‡ºæºèŠ‚ç‚¹å¹¶è¾“å‡º
* åˆ é™¤è¯¥èŠ‚ç‚¹å’Œä¸å®ƒæœ‰è”ç³»çš„æ‰€æœ‰è¾¹
* é‡å¤ï¼Œç›´åˆ°å›¾ä¸ºç©º

## å¼ºè¿é€šåˆ†é‡

![image-20211130172442238](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130172442238.png)

![image-20211130172532295](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130172532295.png)

![image-20211130172545115](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130172545115.png)

æ—¶é—´å¤æ‚åº¦ï¼š$O(m+n)$ï¼ŒåŒ…æ‹¬ä¸€æ¬¡ç”Ÿæˆ $G^T$ å’Œä¸¤æ¬¡DFS

![image-20211130173100261](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130173100261.png)

è¯æ˜è§ã€Šç®—æ³•å¯¼è®ºã€‹ç¬¬ä¸‰ç‰ˆä¸­æ–‡ç‰ˆP358

### Tarjan's SCC Algorithm(äº†è§£å³å¯)

$O(m+n)$

æ›´å¿«ï¼ˆéæ¸è¿›çš„ï¼‰ï¼Œåªè¿›è¡Œä¸€æ¬¡DFS

å»ºè®®çœ‹PPTï¼ˆ13-P22ï¼‰ï¼Œæœ‰åŠ¨ç”»æ›´æ¸…æ¥š

åŸºæœ¬åŸç†ï¼š

<img src="12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130173753219.png" alt="image-20211130173753219" style="zoom:50%;" />

<img src="12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130173838699.png" alt="image-20211130173838699" style="zoom:50%;" />

<img src="12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130173907512.png" alt="image-20211130173907512" style="zoom:50%;" />

![image-20211130173923693](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130173923693.png)

![image-20211130173939626](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130173939626.png)

#### æ‰¾å‡º $r_i$

![image-20211130174033469](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130174033469.png)

![image-20211130174114659](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130174114659.png)

![image-20211130174127447](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130174127447.png)

#### ä¼ªä»£ç 

![image-20211130175053658](12 DFSçš„ä¸€äº›åº”ç”¨.assets/image-20211130175053658.png)

```pseudocode
Tarjan(G):
time = 0
Let S be a stack
for (each node v)
  v.root = NIL
  v.visited = false
for (each node v)
  if (!v.visited)
    TarjanDFS(v)


TarjanDFS(v):
v.visited = true, time = time+1
v.d = time, v.low = v.d
S.push(v)
for (each edge (v,w))
  if (!w.visited) // tree edge
    TarjanDFS(w)
    v.low = min(v.low, w.low)
  else if (w.root == NIL) // non tree edge in ğ¶_ğ‘£
    v.low = min(v.low, w.d)
if (v.low == v.d)
  repeat
    w = S.pop(), w.root = v
  until (w==v)
```

